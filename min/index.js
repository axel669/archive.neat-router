"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react=require("react");function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}const parse=e=>{const t=e.slice(1).split("/").map(e=>{const t=e.match(/^((?<path>\w+)|(:(?<name>\w+)(\((?<regex>.+?)\))?)|(\*(?<rest>\w+$)))$/);if(null===t)return null;const{groups:r}=t;if(void 0!==r.path)return([e,...t])=>e===r.path?t:null;if(void 0!==r.rest)return(e,t)=>(t[r.rest]=e.join("/"),[]);if(void 0!==r.name){const e=void 0===r.regex?/^.+$/:new RegExp(`^${e}$`);return([t,...n],s)=>void 0!==t&&!0===e.test(t)?(s[r.name]=t,n):null}return null});return t.filter(e=>null===e).length>0?(console.warn(`Invalid route: ${e}`),()=>null):(r,{exact:n}={})=>{const s={};let u=r.slice(1).split("/");for(const e of t)if(null===(u=e(u,s)))return null;return u.length>0&&!0===n?null:{url:r,params:s,route:e}}},useMounts=e=>react.useEffect(e,[]),usePathChecker=e=>react.useMemo(()=>parse(e),[e]);function Router(e){return{Route:function(t){const[r,n]=react.useState(e.url),{path:s,exact:u,component:o,...a}=t,l=usePathChecker(s);useMounts(()=>e.subscribe(n));const c=l(r,{exact:u});return null===c?null:React.createElement(o,_extends({},a,{neat:c}))},Switch:function(t){const[r,n]=react.useState(e.url),{children:s,...u}=t,o=react.Children.toArray(s);useMounts(()=>e.subscribe(n));for(const{props:e}of o){const{path:t,exact:n,component:s,...o}=e,a=parse(t)(r,{exact:n});if(null!==a)return React.createElement(s,_extends({},u,o,{neat:a}))}return null}}}const Publisher=()=>{const e=new Map;return{subscribe:t=>{const r=`${Date.now()}:${Math.random()}`;return e.set(r,t),()=>e.delete(r)},publish:t=>{for(const r of e.values())r(t)}}},HashPublisher=()=>{const e=Publisher(),t={get hash(){return location.hash.toString().replace(/^#/,"")},get subscribe(){return e.subscribe},get url(){return t.hash}};t.initialState=t.hash;let r=t.hash;return setInterval(()=>{const n=t.hash;n!==r&&(r=n,e.publish(n))},50),t};exports.HashPublisher=HashPublisher,exports.Publisher=Publisher,exports.Router=Router;
